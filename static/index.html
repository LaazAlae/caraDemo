<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cara - AI-Powered Digital Likeness Protection</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'cara-blue': '#3b82f6',
                        'cara-dark': '#1e293b',
                        'cara-success': '#10b981',
                        'cara-warning': '#f59e0b',
                        'cara-danger': '#ef4444'
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-out',
                        'slide-up': 'slideUp 0.3s ease-out',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite'
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-50 to-blue-50 min-h-screen">
    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 backdrop-blur-lg bg-white/80 border-b border-gray-200/50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-4">
                    <div class="w-10 h-10 bg-gradient-to-r from-cara-blue to-blue-600 rounded-xl flex items-center justify-center">
                        <span class="text-white font-bold text-lg">C</span>
                    </div>
                    <span class="text-xl font-semibold text-cara-dark">Cara</span>
                </div>
                <div class="hidden md:flex items-center space-x-6">
                    <a href="#" class="text-gray-600 hover:text-cara-blue transition-colors">Dashboard</a>
                    <a href="#" class="text-gray-600 hover:text-cara-blue transition-colors">Reports</a>
                    <button class="bg-cara-blue text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors">
                        Get Started
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="pt-24 pb-12">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Hero Section -->
            <div class="text-center mb-16 animate-fade-in">
                <h1 class="text-4xl md:text-5xl font-bold text-cara-dark mb-6">
                    Protect Your Digital Identity with <span class="text-cara-blue">AI Precision</span>
                </h1>
                <p class="text-xl text-gray-600 max-w-3xl mx-auto mb-8">
                    Advanced AI detection across multiple providers to identify unauthorized use of your digital likeness, creative content, and intellectual property.
                </p>
            </div>

            <!-- Upload Section -->
            <div class="bg-white rounded-3xl shadow-xl border border-gray-100 p-8 mb-12 animate-slide-up">
                <div class="text-center mb-8">
                    <h2 class="text-2xl font-semibold text-cara-dark mb-2">Upload for Analysis</h2>
                    <p class="text-gray-600">Drag and drop your files or click to browse</p>
                </div>

                <!-- File Upload Area -->
                <div id="upload-zone" class="relative border-2 border-dashed border-gray-300 rounded-2xl p-12 text-center hover:border-cara-blue transition-all duration-300 cursor-pointer group">
                    <input type="file" id="file-input" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer" multiple accept=".jpg,.jpeg,.png,.gif,.mp3,.wav,.mp4">
                    
                    <div class="space-y-4">
                        <!-- Upload Icon -->
                        <div class="mx-auto w-16 h-16 bg-blue-50 rounded-xl flex items-center justify-center group-hover:bg-blue-100 transition-colors">
                            <svg class="w-8 h-8 text-cara-blue" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                            </svg>
                        </div>

                        <div>
                            <p class="text-lg font-medium text-gray-700 mb-2">
                                <span class="text-cara-blue font-semibold">Click to upload</span> or drag and drop
                            </p>
                            <p class="text-sm text-gray-500">
                                Images (JPG, PNG, GIF), Audio (MP3, WAV), Video (MP4) - Max 50MB per file
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Upload Progress -->
                <div id="upload-progress" class="hidden mt-6">
                    <div class="bg-gray-200 rounded-full h-3 overflow-hidden">
                        <div id="progress-bar" class="bg-gradient-to-r from-cara-blue to-blue-600 h-full transition-all duration-300 ease-out" style="width: 0%"></div>
                    </div>
                    <p id="upload-status" class="text-sm text-gray-600 mt-2">Preparing upload...</p>
                </div>
            </div>

            <!-- Results Section -->
            <div id="results-section" class="hidden animate-fade-in">
                <!-- Overall Risk Assessment -->
                <div class="bg-white rounded-3xl shadow-xl border border-gray-100 p-8 mb-8">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-semibold text-cara-dark">Analysis Results</h2>
                        <div id="overall-risk-badge" class="px-4 py-2 rounded-full text-sm font-semibold">
                            <!-- Risk level badge will be inserted here -->
                        </div>
                    </div>

                    <!-- Risk Meter -->
                    <div class="mb-8">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-medium text-gray-600">Overall Risk Level</span>
                            <span id="confidence-score" class="text-sm font-medium text-gray-900">0%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-4">
                            <div id="risk-meter" class="h-4 rounded-full transition-all duration-1000 ease-out" style="width: 0%"></div>
                        </div>
                    </div>

                    <!-- Provider Results Grid -->
                    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6" id="provider-results">
                        <!-- Provider result cards will be inserted here -->
                    </div>
                </div>

                <!-- Detailed Results -->
                <div class="bg-white rounded-3xl shadow-xl border border-gray-100 p-8">
                    <h3 class="text-xl font-semibold text-cara-dark mb-6">Detailed Analysis</h3>
                    
                    <!-- Tabs -->
                    <div class="border-b border-gray-200 mb-6">
                        <nav class="flex space-x-8">
                            <button class="tab-button active py-3 px-1 border-b-2 border-cara-blue text-cara-blue font-medium text-sm" data-tab="overview">
                                Overview
                            </button>
                            <button class="tab-button py-3 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-sm" data-tab="matches">
                                Matches Found
                            </button>
                            <button class="tab-button py-3 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-sm" data-tab="recommendations">
                                Recommendations
                            </button>
                        </nav>
                    </div>

                    <!-- Tab Content -->
                    <div id="tab-content">
                        <!-- Content will be dynamically loaded -->
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        class CaraAnalysisInterface {
            constructor() {
                this.uploadZone = document.getElementById('upload-zone');
                this.fileInput = document.getElementById('file-input');
                this.progressSection = document.getElementById('upload-progress');
                this.resultsSection = document.getElementById('results-section');
                this.progressBar = document.getElementById('progress-bar');
                this.uploadStatus = document.getElementById('upload-status');
                
                this.initializeEventListeners();
            }

            initializeEventListeners() {
                // File upload events
                this.uploadZone.addEventListener('dragover', this.handleDragOver.bind(this));
                this.uploadZone.addEventListener('dragleave', this.handleDragLeave.bind(this));
                this.uploadZone.addEventListener('drop', this.handleDrop.bind(this));
                this.fileInput.addEventListener('change', this.handleFileSelect.bind(this));

                // Tab navigation
                document.addEventListener('click', (e) => {
                    if (e.target.classList.contains('tab-button')) {
                        this.switchTab(e.target.dataset.tab);
                    }
                });
            }

            handleDragOver(e) {
                e.preventDefault();
                this.uploadZone.classList.add('border-cara-blue', 'bg-blue-50');
            }

            handleDragLeave(e) {
                e.preventDefault();
                this.uploadZone.classList.remove('border-cara-blue', 'bg-blue-50');
            }

            handleDrop(e) {
                e.preventDefault();
                this.uploadZone.classList.remove('border-cara-blue', 'bg-blue-50');
                
                const files = Array.from(e.dataTransfer.files);
                this.processFiles(files);
            }

            handleFileSelect(e) {
                const files = Array.from(e.target.files);
                this.processFiles(files);
            }

            async processFiles(files) {
                if (files.length === 0) return;

                // Show progress section
                this.progressSection.classList.remove('hidden');
                this.uploadStatus.textContent = 'Uploading and analyzing...';
                
                // Animate progress bar
                this.animateProgress();

                // Upload first file (for demo, we'll process one file)
                const file = files[0];
                const formData = new FormData();
                formData.append('file', file);

                try {
                    const response = await fetch('/api/analyze', {
                        method: 'POST',
                        body: formData
                    });

                    if (!response.ok) {
                        throw new Error('Upload failed');
                    }

                    const result = await response.json();
                    this.displayResults(result);
                } catch (error) {
                    this.showError(error.message);
                }
            }

            animateProgress() {
                let progress = 0;
                const interval = setInterval(() => {
                    progress += Math.random() * 15;
                    if (progress > 100) {
                        progress = 100;
                        clearInterval(interval);
                    }
                    
                    this.progressBar.style.width = `${progress}%`;
                    
                    if (progress < 30) {
                        this.uploadStatus.textContent = 'Uploading file...';
                    } else if (progress < 60) {
                        this.uploadStatus.textContent = 'Running AI detection...';
                    } else if (progress < 90) {
                        this.uploadStatus.textContent = 'Aggregating results...';
                    } else {
                        this.uploadStatus.textContent = 'Analysis complete!';
                    }
                }, 200);
            }

            displayResults(result) {
                // Hide progress, show results
                this.progressSection.classList.add('hidden');
                this.resultsSection.classList.remove('hidden');

                // Set overall risk level
                this.setOverallRisk(result.overall_risk_level, result.overall_confidence);

                // Display provider results
                this.displayProviderResults(result);

                // Load default tab content
                this.loadTabContent('overview', result);
            }

            setOverallRisk(riskLevel, confidence) {
                const badge = document.getElementById('overall-risk-badge');
                const meter = document.getElementById('risk-meter');
                const confidenceSpan = document.getElementById('confidence-score');

                // Update badge
                const riskConfig = {
                    'low': { class: 'bg-green-100 text-green-800', text: 'Low Risk' },
                    'medium': { class: 'bg-yellow-100 text-yellow-800', text: 'Medium Risk' },
                    'high': { class: 'bg-red-100 text-red-800', text: 'High Risk' },
                    'critical': { class: 'bg-red-600 text-white', text: 'Critical Risk' }
                };

                const config = riskConfig[riskLevel];
                badge.className = `px-4 py-2 rounded-full text-sm font-semibold ${config.class}`;
                badge.textContent = config.text;

                // Update risk meter
                const meterColors = {
                    'low': 'bg-green-500',
                    'medium': 'bg-yellow-500', 
                    'high': 'bg-red-500',
                    'critical': 'bg-red-600'
                };

                meter.className = `h-4 rounded-full transition-all duration-1000 ease-out ${meterColors[riskLevel]}`;
                meter.style.width = `${confidence}%`;

                confidenceSpan.textContent = `${Math.round(confidence)}% Confidence`;
            }

            displayProviderResults(result) {
                const container = document.getElementById('provider-results');
                container.innerHTML = '';

                const providers = [
                    { name: 'TinEye', key: 'reverse_search', icon: '🔍' },
                    { name: 'AWS Rekognition', key: 'face_detection', icon: '👤' },
                    { name: 'Sensity AI', key: 'deepfake_detection', icon: '🤖' },
                    { name: 'ACRCloud', key: 'audio_fingerprint', icon: '🎵' }
                ];

                providers.forEach(provider => {
                    const providerResult = result[provider.key];
                    if (providerResult) {
                        const card = this.createProviderCard(provider, providerResult);
                        container.appendChild(card);
                    }
                });
            }

            createProviderCard(provider, result) {
                const div = document.createElement('div');
                div.className = 'bg-gray-50 rounded-xl p-4 border border-gray-200';
                
                const riskColors = {
                    'low': 'text-green-600',
                    'medium': 'text-yellow-600',
                    'high': 'text-red-600', 
                    'critical': 'text-red-700'
                };

                div.innerHTML = `
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center space-x-2">
                            <span class="text-lg">${provider.icon}</span>
                            <span class="font-medium text-gray-900">${provider.name}</span>
                        </div>
                        <span class="${riskColors[result.risk_level]} text-sm font-medium">
                            ${result.risk_level.toUpperCase()}
                        </span>
                    </div>
                    <div class="space-y-2">
                        <div class="flex justify-between">
                            <span class="text-sm text-gray-600">Confidence</span>
                            <span class="text-sm font-medium">${Math.round(result.confidence)}%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-sm text-gray-600">Matches</span>
                            <span class="text-sm font-medium">${result.matches_found}</span>
                        </div>
                    </div>
                `;

                return div;
            }

            switchTab(tabName) {
                // Update active tab
                document.querySelectorAll('.tab-button').forEach(btn => {
                    btn.classList.remove('active', 'border-cara-blue', 'text-cara-blue');
                    btn.classList.add('border-transparent', 'text-gray-500');
                });

                const activeTab = document.querySelector(`[data-tab="${tabName}"]`);
                activeTab.classList.add('active', 'border-cara-blue', 'text-cara-blue');
                activeTab.classList.remove('border-transparent', 'text-gray-500');

                // Load tab content
                this.loadTabContent(tabName);
            }

            loadTabContent(tabName, result = null) {
                const content = document.getElementById('tab-content');
                
                switch(tabName) {
                    case 'overview':
                        content.innerHTML = `
                            <div class="space-y-6">
                                <div class="grid md:grid-cols-2 gap-6">
                                    <div class="space-y-4">
                                        <h4 class="font-semibold text-cara-dark">Risk Factors</h4>
                                        <ul class="space-y-2">
                                            <li class="flex items-center space-x-2">
                                                <span class="w-2 h-2 bg-red-500 rounded-full"></span>
                                                <span class="text-sm">Potential unauthorized usage detected</span>
                                            </li>
                                            <li class="flex items-center space-x-2">
                                                <span class="w-2 h-2 bg-yellow-500 rounded-full"></span>
                                                <span class="text-sm">Multiple platform matches found</span>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="space-y-4">
                                        <h4 class="font-semibold text-cara-dark">Analysis Summary</h4>
                                        <p class="text-sm text-gray-600">
                                            Our AI analysis across multiple detection providers has identified 
                                            several potential instances of unauthorized usage of your digital content.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        `;
                        break;
                    
                    case 'matches':
                        content.innerHTML = `
                            <div class="space-y-4">
                                <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-3 h-3 bg-red-500 rounded-full mt-1"></div>
                                        <div class="flex-1">
                                            <h5 class="font-medium text-red-900">High Risk Match</h5>
                                            <p class="text-sm text-red-700 mt-1">
                                                Similar content found on social media platform without attribution
                                            </p>
                                            <p class="text-xs text-red-600 mt-2">Confidence: 94% | Source: Multiple platforms</p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-3 h-3 bg-yellow-500 rounded-full mt-1"></div>
                                        <div class="flex-1">
                                            <h5 class="font-medium text-yellow-900">Medium Risk Match</h5>
                                            <p class="text-sm text-yellow-700 mt-1">
                                                Facial recognition match in public database
                                            </p>
                                            <p class="text-xs text-yellow-600 mt-2">Confidence: 76% | Source: Image database</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                        break;
                    
                    case 'recommendations':
                        content.innerHTML = `
                            <div class="space-y-6">
                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                    <h5 class="font-medium text-blue-900 mb-2">Immediate Actions</h5>
                                    <ul class="space-y-2 text-sm text-blue-800">
                                        <li>• Contact platform administrators for content removal</li>
                                        <li>• Document evidence for potential legal action</li>
                                        <li>• Monitor for additional unauthorized usage</li>
                                    </ul>
                                </div>
                                
                                <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                    <h5 class="font-medium text-green-900 mb-2">Preventive Measures</h5>
                                    <ul class="space-y-2 text-sm text-green-800">
                                        <li>• Implement digital watermarking on future content</li>
                                        <li>• Set up automated monitoring alerts</li>
                                        <li>• Register copyright where applicable</li>
                                    </ul>
                                </div>
                            </div>
                        `;
                        break;
                }
            }

            showError(message) {
                this.progressSection.classList.add('hidden');
                alert(`Error: ${message}`);
            }
        }

        // Initialize the interface when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new CaraAnalysisInterface();
        });
    </script>
</body>
</html>